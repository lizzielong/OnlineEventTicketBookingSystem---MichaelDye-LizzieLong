<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Event Details</title>
  <link rel="stylesheet" href="style/main.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>
<body>
  <!-- Top Green Header (same as other pages) -->
  <header class="top-bar">
    <button class="menu-btn" id="menuToggle">☰</button>
    <nav class="nav-links">
      <a href="index.html">Home</a>
      <a href="bookings.html">My Bookings</a>
      <a href="admin.html">Admin</a>
      <a href="login.html">Login</a>
    </nav>
  </header>

  <!-- User Confirmation Area -->
  <div class="user-status">
    <!-- This will be filled dynamically with JS -->
  </div>



  <!-- Event Content -->
  <main class="event-page">
    <a href="index.html" class="back-btn">← See all events</a>

   <h1 class="event-title">Combined Worship Night</h1>
<p class="event-date">Saturday, October 4, 2025 • 6:30pm</p>

<div class="seat-controls">
  <button class="book-btn">
    <i class="fa-solid fa-chair"></i> Save Seat
  </button>

  <p class="seat-available">
    <strong>Available:</strong> <span id="seatsAvailable">47</span>
  </p>
</div>


<div class="event-details">
  <div class="detail-box" id="about-event">
    <h3>About Event</h3>
    <p id="event-description">
      All important event details can go here that the Admin writes in —
      vision behind the event, what to bring, what to expect, etc.
    </p>
  </div>

  <div class="detail-box" id="about-organization">
    <h3>About Organization/Leader</h3>
    <p id="organization-description">
      All important organization details can go here that the Admin writes in —
      vision behind the organization, how to get connected, etc.
    </p>
  </div>
</div>


  <script>
  // ========== SETTINGS FOR THIS EVENT ==========
  const eventName = "Combined Worship Night"; // You’ll change this per event page

  // Get references to HTML elements
  const bookBtn = document.querySelector(".book-btn");
  const seatsAvailable = document.getElementById("seatsAvailable");
  const userStatus = document.querySelector(".user-status");

  // Get saved bookings from localStorage, or empty array if none exist yet
  let bookings = JSON.parse(localStorage.getItem("bookings")) || [];

  // Save back to localStorage
  function saveBookings() {
    localStorage.setItem("bookings", JSON.stringify(bookings));
  }

  // Show or hide the “I’m going!” box based on user’s booking
  function updateStatusBox() {
    const currentBooking = bookings.find(b => b.name === eventName);

    if (currentBooking && currentBooking.seatsBooked > 0) {
      userStatus.style.display = "block";
      userStatus.innerHTML = `
        <p>I'm going!</p>
        <p>Seats booked: ${currentBooking.seatsBooked}</p>
        <button class="release-btn">Release Seat</button>
      `;

      document
        .querySelector(".release-btn")
        .addEventListener("click", releaseSeat);
    } else {
      userStatus.style.display = "none";
      userStatus.innerHTML = "";
    }
  }

  // Function that runs when user clicks “Save Seat”
  function bookSeat() {
    let currentSeats = parseInt(seatsAvailable.textContent);

    if (currentSeats > 0) {
      seatsAvailable.textContent = currentSeats - 1;

      // Either update existing booking or add a new one
      let existingBooking = bookings.find(b => b.name === eventName);
      if (existingBooking) {
        existingBooking.seatsBooked += 1;
      } else {
        bookings.push({ name: eventName, seatsBooked: 1 });
      }

      saveBookings();
      updateStatusBox();
    } else {
      alert("Sorry, no seats left.");
    }
  }

  // Function that runs when user clicks “Release Seat”
  function releaseSeat() {
    let existingBooking = bookings.find(b => b.name === eventName);

    if (existingBooking && existingBooking.seatsBooked > 0) {
      existingBooking.seatsBooked -= 1;
      seatsAvailable.textContent =
        parseInt(seatsAvailable.textContent) + 1;

      // If zero seats left, remove from the booking list
      if (existingBooking.seatsBooked === 0) {
        bookings = bookings.filter(b => b.name !== eventName);
      }

      saveBookings();
      updateStatusBox();
    }
  }

  // Attach button click listener
  bookBtn.addEventListener("click", bookSeat);

  // Run this once when the page loads (to restore any saved state)
  updateStatusBox();
</script>

</body>
</html>
